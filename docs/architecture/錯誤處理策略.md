# 錯誤處理策略

## 錯誤流程

```mermaid
sequenceDiagram
    participant U as User
    participant C as Command Handler
    participant S as Service
    participant D as Database
    participant L as Logger
    participant N as Notifier
    
    U->>C: Discord Command
    C->>S: Business Logic Call
    S->>D: Database Operation
    D-->>S: Error Occurred
    S->>L: Log Error Details
    S->>S: Determine Error Type
    S-->>C: Formatted Error Response
    C->>N: User-friendly Message
    N-->>U: Error Notification
```

## 錯誤回應格式

```python
class BotError(Exception):
    def __init__(self, message: str, error_code: str, details: dict = None):
        self.message = message
        self.error_code = error_code
        self.details = details or {}
        self.timestamp = datetime.utcnow()
        super().__init__(message)
