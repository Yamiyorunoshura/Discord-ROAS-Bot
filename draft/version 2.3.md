# 2.3 版本規劃：單元測試完善、現有模組修復、效能優化與靜態檢查合規

## 目標
- 全面補齊現有模組的單元測試，提升測試覆蓋率至預期標準（如 85% 以上）。
- 系統性檢查並修復現有功能模組中的已知與潛在 bug。
- 強化測試流程，確保未來新功能開發不影響穩定性。
- 在所有模組中引入 numpy，以提升運算效能。
- 導入 dpytest，協助 Discord 機器人相關功能的 debug 與測試。
- 全面導入 ruff 及 mypy 靜態檢查，確保程式碼風格與型別安全，並在不影響功能的前提下，所有代碼皆符合 ruff 及 mypy 的要求。

## 主要工作項目

### 1. 單元測試補全
- 盤點所有現有模組（如政府系統、成就面板、用戶管理等）測試覆蓋率。
- 為缺漏的功能、邊界情境與異常流程撰寫單元測試。
- 強化互動元件（如 Discord View、Modal、Button 等）的行為測試。
- 建立效能與壓力測試，確保關鍵操作在時限內完成。
- 在測試流程中導入 dpytest，提升 Discord 機器人互動測試的準確性與效率。

### 2. Bug 尋找與修復
- 彙整現有 issue tracker、用戶回饋與測試報告中的 bug。
- 針對測試過程中發現的新問題，建立回報與修復流程。
- 修正所有已知 bug，並撰寫回歸測試防止重現。

### 3. 效能優化與技術升級
- 在所有模組中引入 numpy，優化數據處理與運算相關邏輯，提升整體效能。
- 針對高運算需求的功能進行重構，確保能充分發揮 numpy 的效能優勢。

### 4. 靜態檢查與程式碼合規
- 導入 ruff（程式碼風格/靜態分析）與 mypy（型別檢查）於開發流程。
- 針對現有所有模組進行 ruff 及 mypy 全面檢查，修正不合規之處（如型別註解、語法、命名、未使用變數等），確保不影響原有功能。
- 建立自動化檢查流程，於 CI 階段自動執行 ruff 及 mypy，防止不合規程式碼進入主分支。
- 撰寫相關開發指引，要求新程式碼必須通過 ruff 及 mypy 檢查。

### 5. 測試流程優化
- 統一測試規範與命名，完善測試文件與執行指引。
- 整合自動化測試（CI），確保每次提交皆自動驗證。
- 定期審查測試覆蓋率，持續追蹤品質指標。

## 預期成果
- 所有現有模組單元測試覆蓋率達標，主要流程皆有自動化測試保障。
- 已知 bug 全數修復，系統穩定性顯著提升。
- numpy 成功整合至所有模組，運算效能明顯提升。
- Discord 機器人相關功能測試更為完善，debug 效率提升。
- 所有程式碼皆符合 ruff 及 mypy 檢查要求，維護品質與可讀性大幅提升。
- 建立完善的測試、靜態檢查與回歸機制，為後續新功能開發打下堅實基礎。

## 備註
- 本次版本不新增大型新功能，專注於品質提升、效能優化、技術債還款與靜態檢查合規。
- 若測試或靜態檢查過程中發現架構性問題，將提出重構建議並納入後續規劃。
