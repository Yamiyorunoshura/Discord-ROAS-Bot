{
  "timestamp": 1756060499.354233,
  "environment": "dev",
  "project_root": "/Users/tszkinlai/Coding/roas-bot",
  "stages": {
    "environment_check": {
      "success": true,
      "passed": true,
      "errors": [],
      "issues": [],
      "report": {
        "timestamp": "2025-08-25T02:34:59.617306",
        "system_info": {
          "os": "Darwin",
          "version": "24.6.0",
          "python_version": "3.13.5",
          "architecture": "arm64"
        },
        "validation_results": [
          "ValidationResult(name='作業系統支援', passed=True, message='作業系統 Darwin 受支援', details={'os': 'Darwin', 'version': '24.6.0'}, suggestions=None)",
          "ValidationResult(name='Python版本', passed=True, message='Python 3.13 符合需求', details={'version': '3.13.5'}, suggestions=None)",
          "ValidationResult(name='系統記憶體', passed=True, message='可用記憶體: 16.0GB', details={'total_gb': 16.0, 'available_gb': 4.9}, suggestions=None)",
          "ValidationResult(name='Docker版本', passed=True, message='Docker已安裝: Docker version 28.3.2, build 578ccf6', details={'version_output': 'Docker version 28.3.2, build 578ccf6'}, suggestions=None)",
          "ValidationResult(name='Docker Compose V2', passed=True, message='Docker Compose V2可用: Docker Compose version v2.38.2-desktop.1', details={'version_output': 'Docker Compose version v2.38.2-desktop.1'}, suggestions=None)",
          "ValidationResult(name='Docker服務', passed=True, message='Docker daemon正在運行', details={'docker_info_available': True}, suggestions=None)",
          "ValidationResult(name='配置檔案: pyproject.toml', passed=True, message='pyproject.toml 存在', details={'path': '/Users/tszkinlai/Coding/roas-bot/pyproject.toml'}, suggestions=None)",
          "ValidationResult(name='配置檔案: Dockerfile', passed=True, message='Dockerfile 存在', details={'path': '/Users/tszkinlai/Coding/roas-bot/Dockerfile'}, suggestions=None)",
          "ValidationResult(name='配置檔案: docker-compose.dev.yml', passed=True, message='docker-compose.dev.yml 存在', details={'path': '/Users/tszkinlai/Coding/roas-bot/docker-compose.dev.yml'}, suggestions=None)",
          "ValidationResult(name='配置檔案: docker-compose.prod.yml', passed=True, message='docker-compose.prod.yml 存在', details={'path': '/Users/tszkinlai/Coding/roas-bot/docker-compose.prod.yml'}, suggestions=None)",
          "ValidationResult(name='Compose語法: docker-compose.dev.yml', passed=True, message='docker-compose.dev.yml 語法正確', details=None, suggestions=None)",
          "ValidationResult(name='Compose語法: docker-compose.prod.yml', passed=True, message='docker-compose.prod.yml 語法正確', details=None, suggestions=None)",
          "ValidationResult(name='環境變數: DISCORD_TOKEN', passed=True, message='DISCORD_TOKEN 已設定', details={'description': '必要的Discord機器人Token', 'has_value': True}, suggestions=None)",
          "ValidationResult(name='可選變數: ENVIRONMENT', passed=True, message='ENVIRONMENT = development', details={'description': '執行環境 (development/production)'}, suggestions=None)",
          "ValidationResult(name='端口檢查: 6379', passed=True, message='端口 6379 可用', details=None, suggestions=None)",
          "ValidationResult(name='端口檢查: 8000', passed=True, message='端口 8000 可用', details=None, suggestions=None)",
          "ValidationResult(name='端口檢查: 3000', passed=True, message='端口 3000 可用', details=None, suggestions=None)",
          "ValidationResult(name='端口檢查: 9090', passed=True, message='端口 9090 可用', details=None, suggestions=None)",
          "ValidationResult(name='磁盤空間', passed=True, message='可用空間: 63.2GB', details={'free_space_gb': 63.2}, suggestions=None)",
          "ValidationResult(name='目錄權限: data', passed=True, message='data 目錄權限正常', details={'path': '/Users/tszkinlai/Coding/roas-bot/data'}, suggestions=None)",
          "ValidationResult(name='目錄權限: logs', passed=True, message='logs 目錄權限正常', details={'path': '/Users/tszkinlai/Coding/roas-bot/logs'}, suggestions=None)",
          "ValidationResult(name='目錄權限: backups', passed=True, message='backups 目錄權限正常', details={'path': '/Users/tszkinlai/Coding/roas-bot/backups'}, suggestions=None)"
        ],
        "overall_status": true,
        "critical_issues": [],
        "warnings": [],
        "recommendations": []
      },
      "critical_count": 0,
      "warning_count": 0
    },
    "docker_check": {
      "success": true,
      "health_check": {
        "timestamp": 1756060499.617355,
        "overall_healthy": false,
        "services": {},
        "summary": {
          "total": 0,
          "healthy": 0,
          "unhealthy": 0,
          "unknown": 0
        }
      },
      "zombie_containers": {
        "count": 0,
        "has_zombies": false,
        "output": "CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES\n"
      },
      "resource_check": {
        "cpu_usage_percent": 7.9,
        "memory_total_gb": 16.0,
        "memory_available_gb": 4.8607025146484375,
        "memory_usage_percent": 69.6,
        "resources_sufficient": true
      }
    },
    "deployment_preparation": {
      "success": true,
      "actions": [
        {
          "action": "cleanup_containers",
          "success": true,
          "message": "容器清理完成: 所有服務已成功停止"
        },
        {
          "action": "disk_space_check",
          "success": true,
          "message": "可用空間: 63.2GB"
        },
        {
          "action": "prepare_directories",
          "success": true,
          "message": "所有目錄已存在"
        }
      ]
    },
    "deployment": {
      "success": false,
      "attempts": [
        {
          "attempt": 1,
          "success": false,
          "message": "服務啟動失敗",
          "timestamp": 1756060548.326779,
          "diagnosis": {
            "timestamp": 1756060548.326831,
            "possible_causes": [
              "服務日誌中發現錯誤訊息",
              "端口 6379 可能被其他程序佔用",
              "端口 8000 可能被其他程序佔用"
            ],
            "recommendations": [
              "檢查服務日誌以獲取詳細錯誤資訊",
              "檢查並關閉佔用端口 6379 的程序",
              "檢查並關閉佔用端口 8000 的程序"
            ]
          }
        }
      ],
      "message": "部署失敗，已嘗試 1 次"
    }
  },
  "overall_success": false,
  "deployment_successful": false,
  "issues_found": [],
  "fixes_applied": [],
  "final_status": {
    "timestamp": 1756060548.5408158,
    "compose_file": "docker-compose.dev.yml",
    "project_root": "/Users/tszkinlai/Coding/roas-bot",
    "services": [
      {
        "name": "discord-bot-dev",
        "container_id": "32998a05f1b6",
        "status": "running",
        "health_status": "starting",
        "ports": [
          {
            "URL": "0.0.0.0",
            "TargetPort": 8000,
            "PublishedPort": 8000,
            "Protocol": "tcp"
          },
          {
            "URL": "::",
            "TargetPort": 8000,
            "PublishedPort": 8000,
            "Protocol": "tcp"
          }
        ],
        "created_at": "2025-08-25 02:35:42 +0800 HKT",
        "started_at": null,
        "message": "Up Less than a second (health: starting)"
      },
      {
        "name": "discord-bot-prometheus",
        "container_id": "75eee84837f7",
        "status": "starting",
        "health_status": null,
        "ports": [],
        "created_at": "2025-08-25 02:35:42 +0800 HKT",
        "started_at": null,
        "message": "Restarting (2) 1 second ago"
      },
      {
        "name": "discord-bot-redis",
        "container_id": "f99e0938cee5",
        "status": "healthy",
        "health_status": "healthy",
        "ports": [
          {
            "URL": "0.0.0.0",
            "TargetPort": 6379,
            "PublishedPort": 6379,
            "Protocol": "tcp"
          },
          {
            "URL": "::",
            "TargetPort": 6379,
            "PublishedPort": 6379,
            "Protocol": "tcp"
          }
        ],
        "created_at": "2025-08-25 02:35:42 +0800 HKT",
        "started_at": null,
        "message": "Up 5 seconds (healthy)"
      }
    ],
    "summary": {
      "total_services": 3,
      "running_services": 1,
      "healthy_services": 1,
      "failed_services": 0
    }
  }
}